source("final_project.R")

# Create summarization data frame

# For built units data 

# Total number of built units from 2013-2019
total_built_units <- nrow(joined_df)

# Total number of built units from 2013
built_units_2013 <- nrow(joined_df[joined_df$YEAR_FINAL == 2013,])

# Total number of built units from 2014
built_units_2014 <- nrow(joined_df[joined_df$YEAR_FINAL == 2014,])

# Total number of built units from 2015
built_units_2015 <- nrow(joined_df[joined_df$YEAR_FINAL == 2015,])

# Total number of built units from 2016
built_units_2016 <- nrow(joined_df[joined_df$YEAR_FINAL == 2016,])

# Total number of built units from 2017
built_units_2017 <- nrow(joined_df[joined_df$YEAR_FINAL == 2017,])

# Total number of built units from 2018
built_units_2018 <- nrow(joined_df[joined_df$YEAR_FINAL == 2018,])

# Total number of built units from 2019
built_units_2019 <- nrow(joined_df[joined_df$YEAR_FINAL == 2019,])

# Average number of built units from 2013-2019
avg_built_units <- mean(c(built_units_2013, built_units_2014, built_units_2015,
                          built_units_2016, built_units_2017, built_units_2018,
                          built_units_2019))

# Write a function to find the built units for a year and a census block group 
find_built_units <- function(year, geo_id){
  filter <- joined_df$YEAR_FINAL == year & joined_df$GEO_ID == geo_id 
  bu_num <- nrow(joined_df[filter,])
  return(bu_num)
}

# For 2013:
bu_2013_1500000US530330050001 <- find_built_units(2013, "1500000US530330050001")
bu_2013_1500000US530330050002 <- find_built_units(2013, "1500000US530330050002")
bu_2013_1500000US530330050003 <- find_built_units(2013, "1500000US530330050003")
bu_2013_1500000US530330051001 <- find_built_units(2013, "1500000US530330051001")
bu_2013_1500000US530330051002 <- find_built_units(2013, "1500000US530330051002")
bu_2013_1500000US530330051003 <- find_built_units(2013, "1500000US530330051002")
bu_2013_1500000US530330052001 <- find_built_units(2013, "1500000US530330052001")
bu_2013_1500000US530330052002 <- find_built_units(2013, "1500000US530330052002")
bu_2013_1500000US530330052003 <- find_built_units(2013, "1500000US530330052003")
bu_2013_1500000US530330052004 <- find_built_units(2013, "1500000US530330052004")
bu_2013_1500000US530330052005 <- find_built_units(2013, "1500000US530330052005")
bu_2013_1500000US530330090001 <- find_built_units(2013, "1500000US530330090001")
bu_2013_1500000US530330090002 <- find_built_units(2013, "1500000US530330090002")
bu_2013_1500000US530330091001 <- find_built_units(2013, "1500000US530330091001")
bu_2013_1500000US530330091002 <- find_built_units(2013, "1500000US530330091002")

# For 2014:
bu_2014_1500000US530330050001 <- find_built_units(2014, "1500000US530330050001")
bu_2014_1500000US530330050002 <- find_built_units(2014, "1500000US530330050002")
bu_2014_1500000US530330050003 <- find_built_units(2014, "1500000US530330050003")
bu_2014_1500000US530330051001 <- find_built_units(2014, "1500000US530330051001")
bu_2014_1500000US530330051002 <- find_built_units(2014, "1500000US530330051002")
bu_2014_1500000US530330051003 <- find_built_units(2014, "1500000US530330051002")
bu_2014_1500000US530330052001 <- find_built_units(2014, "1500000US530330052001")
bu_2014_1500000US530330052002 <- find_built_units(2014, "1500000US530330052002")
bu_2014_1500000US530330052003 <- find_built_units(2014, "1500000US530330052003")
bu_2014_1500000US530330052004 <- find_built_units(2014, "1500000US530330052004")
bu_2014_1500000US530330052005 <- find_built_units(2014, "1500000US530330052005")
bu_2014_1500000US530330090001 <- find_built_units(2014, "1500000US530330090001")
bu_2014_1500000US530330090002 <- find_built_units(2014, "1500000US530330090002")
bu_2014_1500000US530330091001 <- find_built_units(2014, "1500000US530330091001")
bu_2014_1500000US530330091002 <- find_built_units(2014, "1500000US530330091002")

# For 2015:
bu_2015_1500000US530330050001 <- find_built_units(2015, "1500000US530330050001")
bu_2015_1500000US530330050002 <- find_built_units(2015, "1500000US530330050002")
bu_2015_1500000US530330050003 <- find_built_units(2015, "1500000US530330050003")
bu_2015_1500000US530330051001 <- find_built_units(2015, "1500000US530330051001")
bu_2015_1500000US530330051002 <- find_built_units(2015, "1500000US530330051002")
bu_2015_1500000US530330051003 <- find_built_units(2015, "1500000US530330051002")
bu_2015_1500000US530330052001 <- find_built_units(2015, "1500000US530330052001")
bu_2015_1500000US530330052002 <- find_built_units(2015, "1500000US530330052002")
bu_2015_1500000US530330052003 <- find_built_units(2015, "1500000US530330052003")
bu_2015_1500000US530330052004 <- find_built_units(2015, "1500000US530330052004")
bu_2015_1500000US530330052005 <- find_built_units(2015, "1500000US530330052005")
bu_2015_1500000US530330090001 <- find_built_units(2015, "1500000US530330090001")
bu_2015_1500000US530330090002 <- find_built_units(2015, "1500000US530330090002")
bu_2015_1500000US530330091001 <- find_built_units(2015, "1500000US530330091001")
bu_2015_1500000US530330091002 <- find_built_units(2015, "1500000US530330091002")

# For 2016: 
bu_2016_1500000US530330050001 <- find_built_units(2016, "1500000US530330050001")
bu_2016_1500000US530330050002 <- find_built_units(2016, "1500000US530330050002")
bu_2016_1500000US530330050003 <- find_built_units(2016, "1500000US530330050003")
bu_2016_1500000US530330051001 <- find_built_units(2016, "1500000US530330051001")
bu_2016_1500000US530330051002 <- find_built_units(2016, "1500000US530330051002")
bu_2016_1500000US530330051003 <- find_built_units(2016, "1500000US530330051002")
bu_2016_1500000US530330052001 <- find_built_units(2016, "1500000US530330052001")
bu_2016_1500000US530330052002 <- find_built_units(2016, "1500000US530330052002")
bu_2016_1500000US530330052003 <- find_built_units(2016, "1500000US530330052003")
bu_2016_1500000US530330052004 <- find_built_units(2016, "1500000US530330052004")
bu_2016_1500000US530330052005 <- find_built_units(2016, "1500000US530330052005")
bu_2016_1500000US530330090001 <- find_built_units(2016, "1500000US530330090001")
bu_2016_1500000US530330090002 <- find_built_units(2016, "1500000US530330090002")
bu_2016_1500000US530330091001 <- find_built_units(2016, "1500000US530330091001")
bu_2016_1500000US530330091002 <- find_built_units(2016, "1500000US530330091002")

# For 2017:
bu_2017_1500000US530330050001 <- find_built_units(2017, "1500000US530330050001")
bu_2017_1500000US530330050002 <- find_built_units(2017, "1500000US530330050002")
bu_2017_1500000US530330050003 <- find_built_units(2017, "1500000US530330050003")
bu_2017_1500000US530330051001 <- find_built_units(2017, "1500000US530330051001")
bu_2017_1500000US530330051002 <- find_built_units(2017, "1500000US530330051002")
bu_2017_1500000US530330051003 <- find_built_units(2017, "1500000US530330051002")
bu_2017_1500000US530330052001 <- find_built_units(2017, "1500000US530330052001")
bu_2017_1500000US530330052002 <- find_built_units(2017, "1500000US530330052002")
bu_2017_1500000US530330052003 <- find_built_units(2017, "1500000US530330052003")
bu_2017_1500000US530330052004 <- find_built_units(2017, "1500000US530330052004")
bu_2017_1500000US530330052005 <- find_built_units(2017, "1500000US530330052005")
bu_2017_1500000US530330090001 <- find_built_units(2017, "1500000US530330090001")
bu_2017_1500000US530330090002 <- find_built_units(2017, "1500000US530330090002")
bu_2017_1500000US530330091001 <- find_built_units(2017, "1500000US530330091001")
bu_2017_1500000US530330091002 <- find_built_units(2017, "1500000US530330091002")

# For 2018:
bu_2018_1500000US530330050001 <- find_built_units(2018, "1500000US530330050001")
bu_2018_1500000US530330050002 <- find_built_units(2018, "1500000US530330050002")
bu_2018_1500000US530330050003 <- find_built_units(2018, "1500000US530330050003")
bu_2018_1500000US530330051001 <- find_built_units(2018, "1500000US530330051001")
bu_2018_1500000US530330051002 <- find_built_units(2018, "1500000US530330051002")
bu_2018_1500000US530330051003 <- find_built_units(2018, "1500000US530330051002")
bu_2018_1500000US530330052001 <- find_built_units(2018, "1500000US530330052001")
bu_2018_1500000US530330052002 <- find_built_units(2018, "1500000US530330052002")
bu_2018_1500000US530330052003 <- find_built_units(2018, "1500000US530330052003")
bu_2018_1500000US530330052004 <- find_built_units(2018, "1500000US530330052004")
bu_2018_1500000US530330052005 <- find_built_units(2018, "1500000US530330052005")
bu_2018_1500000US530330090001 <- find_built_units(2018, "1500000US530330090001")
bu_2018_1500000US530330090002 <- find_built_units(2018, "1500000US530330090002")
bu_2018_1500000US530330091001 <- find_built_units(2018, "1500000US530330091001")
bu_2018_1500000US530330091002 <- find_built_units(2018, "1500000US530330091002")

# For 2019:
bu_2019_1500000US530330050001 <- find_built_units(2019, "1500000US530330050001")
bu_2019_1500000US530330050002 <- find_built_units(2019, "1500000US530330050002")
bu_2019_1500000US530330050003 <- find_built_units(2019, "1500000US530330050003")
bu_2019_1500000US530330051001 <- find_built_units(2019, "1500000US530330051001")
bu_2019_1500000US530330051002 <- find_built_units(2019, "1500000US530330051002")
bu_2019_1500000US530330051003 <- find_built_units(2019, "1500000US530330051002")
bu_2019_1500000US530330052001 <- find_built_units(2019, "1500000US530330052001")
bu_2019_1500000US530330052002 <- find_built_units(2019, "1500000US530330052002")
bu_2019_1500000US530330052003 <- find_built_units(2019, "1500000US530330052003")
bu_2019_1500000US530330052004 <- find_built_units(2019, "1500000US530330052004")
bu_2019_1500000US530330052005 <- find_built_units(2019, "1500000US530330052005")
bu_2019_1500000US530330090001 <- find_built_units(2019, "1500000US530330090001")
bu_2019_1500000US530330090002 <- find_built_units(2019, "1500000US530330090002")
bu_2019_1500000US530330091001 <- find_built_units(2019, "1500000US530330091001")
bu_2019_1500000US530330091002 <- find_built_units(2019, "1500000US530330091002")

# Create summarization data frame 
summarization_df <- data.frame(built_units_2013, built_units_2014, built_units_2015,
                               built_units_2016, built_units_2017, built_units_2018,
                               built_units_2019, 
                               
                               # 2013
                               bu_2013_1500000US530330050001,
                               bu_2013_1500000US530330050002, bu_2013_1500000US530330050003,
                               bu_2013_1500000US530330051001, bu_2013_1500000US530330051002,
                               bu_2013_1500000US530330051003, bu_2013_1500000US530330052001,
                               bu_2013_1500000US530330052002, bu_2013_1500000US530330052003,
                               bu_2013_1500000US530330052004, bu_2013_1500000US530330052005, 
                               bu_2013_1500000US530330090001, bu_2013_1500000US530330090002, 
                               bu_2013_1500000US530330091001, bu_2013_1500000US530330091002, 
                               
                               # 2014
                               bu_2014_1500000US530330050001,
                               bu_2014_1500000US530330050002, bu_2014_1500000US530330050003,
                               bu_2014_1500000US530330051001, bu_2014_1500000US530330051002,
                               bu_2014_1500000US530330051003, bu_2014_1500000US530330052001,
                               bu_2014_1500000US530330052002, bu_2014_1500000US530330052003,
                               bu_2014_1500000US530330052004, bu_2014_1500000US530330052005, 
                               bu_2014_1500000US530330090001, bu_2014_1500000US530330090002, 
                               bu_2014_1500000US530330091001, bu_2014_1500000US530330091002,
                               
                               # 2015
                               bu_2015_1500000US530330050001,
                               bu_2015_1500000US530330050002, bu_2015_1500000US530330050003,
                               bu_2015_1500000US530330051001, bu_2015_1500000US530330051002,
                               bu_2015_1500000US530330051003, bu_2015_1500000US530330052001,
                               bu_2015_1500000US530330052002, bu_2015_1500000US530330052003,
                               bu_2015_1500000US530330052004, bu_2015_1500000US530330052005, 
                               bu_2015_1500000US530330090001, bu_2015_1500000US530330090002, 
                               bu_2015_1500000US530330091001, bu_2015_1500000US530330091002,
                               
                               # 2016
                               bu_2016_1500000US530330050001,
                               bu_2016_1500000US530330050002, bu_2016_1500000US530330050003,
                               bu_2016_1500000US530330051001, bu_2016_1500000US530330051002,
                               bu_2016_1500000US530330051003, bu_2016_1500000US530330052001,
                               bu_2016_1500000US530330052002, bu_2016_1500000US530330052003,
                               bu_2016_1500000US530330052004, bu_2016_1500000US530330052005, 
                               bu_2016_1500000US530330090001, bu_2016_1500000US530330090002, 
                               bu_2016_1500000US530330091001, bu_2016_1500000US530330091002,
                               
                               # 2017
                               bu_2017_1500000US530330050001,
                               bu_2017_1500000US530330050002, bu_2017_1500000US530330050003,
                               bu_2017_1500000US530330051001, bu_2017_1500000US530330051002,
                               bu_2017_1500000US530330051003, bu_2017_1500000US530330052001,
                               bu_2017_1500000US530330052002, bu_2017_1500000US530330052003,
                               bu_2017_1500000US530330052004, bu_2017_1500000US530330052005, 
                               bu_2017_1500000US530330090001, bu_2017_1500000US530330090002, 
                               bu_2017_1500000US530330091001, bu_2017_1500000US530330091002,
                               
                               # 2018
                               bu_2018_1500000US530330050001,
                               bu_2018_1500000US530330050002, bu_2018_1500000US530330050003,
                               bu_2018_1500000US530330051001, bu_2018_1500000US530330051002,
                               bu_2018_1500000US530330051003, bu_2018_1500000US530330052001,
                               bu_2018_1500000US530330052002, bu_2018_1500000US530330052003,
                               bu_2018_1500000US530330052004, bu_2018_1500000US530330052005, 
                               bu_2018_1500000US530330090001, bu_2018_1500000US530330090002, 
                               bu_2018_1500000US530330091001, bu_2018_1500000US530330091002,
                               
                               # 2019
                               bu_2019_1500000US530330050001,
                               bu_2019_1500000US530330050002, bu_2019_1500000US530330050003,
                               bu_2019_1500000US530330051001, bu_2019_1500000US530330051002,
                               bu_2019_1500000US530330051003, bu_2019_1500000US530330052001,
                               bu_2019_1500000US530330052002, bu_2019_1500000US530330052003,
                               bu_2019_1500000US530330052004, bu_2019_1500000US530330052005, 
                               bu_2019_1500000US530330090001, bu_2019_1500000US530330090002, 
                               bu_2019_1500000US530330091001, bu_2019_1500000US530330091002
)



